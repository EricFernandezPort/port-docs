import Tabs from "@theme/Tabs"
import TabItem from "@theme/TabItem"
import AdvancedConfig from '../../../generalTemplates/_ocean_advanced_configuration_note.md'
import AzurePremise from "../templates/\_ocean_azure_premise.mdx"
import DockerParameters from "./\_kafka_one_time_docker_params.mdx"
import HelmParameters from "../templates/\_ocean-advanced-parameters-helm.mdx"
import PortApiRegionTip from "/docs/generalTemplates/_port_region_parameter_explanation_template.md"


# Event catalog

Port acts as an event catalog for event-driven architectures, serving as a centralized repository for your event schemas, API schemas, documentation, as well as mapping the relationships between event producers and consumers in your overall architecture.

## Common use cases

- Map relationships between events, producers, and consumers in your event-driven architecture.
- Document all event schemas and APIs so developers have the information needed to write new services.
- Automatically ingest schemas, producer/consumer relationships, and APIs to ensure the catalog is up to date.

## Data model overview

<img src='/img/build-your-software-catalog/sync-data-to-catalog/event-processing/event-catalog-data-model.png' width='100%' />

Your architecture in Port will consist of four blueprints: `Producer`, `Event Pipeline`, `Event`, and `Consumer`. The structure of these blueprints may vary based on your architecture and may be different than the examples provided in this guide.

### Producer

- The `Producer` blueprint represents services that will generate events. It has a [relation](https://docs.getport.io/build-your-software-catalog/customize-integrations/configure-data-model/relate-blueprints/) connecting it to the event pipeline blueprint.
  
### Event pipeline

- The `Event Pipeline` blueprint represents services that will act as a queue for events and route them to the proper destination. The `Event Pipeline` blueprint has one relation with the `Event` blueprint for events that are ingested by the pipeline, another relation with the `Event` blueprint for events that are produced from the pipeline, and finally the pipeline has a relation connecting it to the `Consumer` blueprint. 

### Event

- The `Event` blueprint forms the schema for tracking unique events in your event-driven architecture. It has a relation connecting it to the producers which originally generated the event and a relation connecting it to the consumers which consumed the event. 

### Consumer

- The `Consumer` blueprint represents services that consume events generated by the event pipeline.


## Event catalog configuration

### Blueprint creation

:::tip Already deployed?
If you already have blueprints in Port for your event producer, event consumer, and event pipeline you can skip the deployment for those blueprints and deploy just the event blueprint. You will still have to modify the blueprints to create relations between the different components in your event-driven architecture.
:::

To create an event catalog, we first need to create the  `Producer`, `Event Pipeline`, `Event`, and `Consumer` blueprints in our data model. This includes defining the relations between the blueprints in your architecture in the `relations` section of each JSON. Examples for each blueprint including the relation configuration are provided below, but the exact configuration of your blueprints will differ from the examples provided here depending on your architecture.

:::tip Don't know how to deploy blueprints?
Check out this [guide](https://docs.getport.io/build-your-software-catalog/customize-integrations/configure-data-model/setup-blueprint/) on how to deploy blueprints in Port
:::

<details>
<summary>Example producer blueprint</summary>

```json showLineNumbers
{
  "identifier": "producer",
  "description": "This blueprint represents an event Producer in our software catalog",
  "title": "Producer",
  "icon": "Lambda",
  "schema": {
    "properties": {
      "link": {
        "type": "string",
        "format": "url",
        "title": "Link"
      },
      "description": {
        "type": "string",
        "title": "Description"
      },
      "memorySize": {
        "type": "number",
        "title": "Memory Size"
      },
      "ephemeralStorageSize": {
        "type": "number",
        "title": "Ephemeral Storage Size"
      },
      "timeout": {
        "type": "number",
        "title": "Timeout"
      },
      "runtime": {
        "type": "string",
        "title": "Runtime"
      },
      "packageType": {
        "type": "string",
        "enum": [
          "Image",
          "Zip"
        ],
        "title": "Package Type"
      },
      "environment": {
        "type": "object",
        "title": "Environment"
      },
      "architectures": {
        "type": "array",
        "items": {
          "type": "string",
          "enum": [
            "x86_64",
            "arm64"
          ]
        },
        "title": "Architectures"
      },
      "layers": {
        "type": "array",
        "title": "Layers"
      },
      "tags": {
        "type": "array",
        "title": "Tags"
      },
      "iamRole": {
        "type": "string",
        "format": "url",
        "title": "IAM Role",
        "icon": "Unlock"
      },
      "arn": {
        "type": "string",
        "title": "ARN"
      }
    },
    "required": []
  },
  "mirrorProperties": {},
  "calculationProperties": {},
  "aggregationProperties": {},
  "relations": {
    "pipeline": {
      "title": "Event Pipeline",
      "target": "pipeline",
      "required": false,
      "many": false
    },
    "event_i_produce": {
      "title": "Event I Produce",
      "target": "event",
      "required": false,
      "many": true
    }
  }
}
```
</details>

<details>
<summary>Example event pipeline blueprint</summary>

```json showLineNumbers
{
  "identifier": "pipeline",
  "title": "Event Pipeline",
  "icon": "GitLab",
  "schema": {
    "properties": {
      "readme": {
        "title": "README",
        "type": "string",
        "format": "markdown",
        "icon": "Book"
      },
      "url": {
        "title": "URL",
        "format": "url",
        "type": "string",
        "icon": "Link"
      },
      "language": {
        "icon": "Git",
        "type": "string",
        "title": "Language",
        "enum": [
          "GO",
          "Python",
          "Node",
          "React"
        ],
        "enumColors": {
          "GO": "red",
          "Python": "green",
          "Node": "blue",
          "React": "yellow"
        }
      },
      "code_owners": {
        "title": "Code owners",
        "description": "This service's code owners",
        "type": "array",
        "icon": "TwoUsers",
        "items": {
          "type": "string",
          "format": "user"
        }
      },
      "type": {
        "title": "Type",
        "description": "This service's type",
        "type": "string",
        "enum": [
          "Backend",
          "Frontend",
          "Library"
        ],
        "enumColors": {
          "Backend": "purple",
          "Frontend": "pink",
          "Library": "green"
        },
        "icon": "DefaultProperty"
      },
      "lifecycle": {
        "title": "Lifecycle",
        "type": "string",
        "enum": [
          "Production",
          "Experimental",
          "Deprecated"
        ],
        "enumColors": {
          "Production": "green",
          "Experimental": "yellow",
          "Deprecated": "red"
        },
        "icon": "DefaultProperty"
      },
      "locked_in_prod": {
        "icon": "DefaultProperty",
        "title": "Locked in Prod",
        "type": "boolean",
        "default": false
      },
      "locked_reason_prod": {
        "icon": "DefaultProperty",
        "title": "Locked Reason Prod",
        "type": "string"
      }
    },
    "required": []
  },
  "mirrorProperties": {},
  "calculationProperties": {},
  "aggregationProperties": {},
  "relations": {
    "event_i_produce": {
      "title": "Event I Produce",
      "target": "event",
      "required": false,
      "many": false
    },
    "consumer": {
      "title": "Consumer",
      "target": "consumer",
      "required": false,
      "many": false
    }
  }
}
```
</details>


<details>
<summary>Example event blueprint</summary>

```json showLineNumbers
{
  "identifier": "event",
  "title": "Event",
  "icon": "Mail",
  "schema": {
    "properties": {
      "async_api": {
        "type": "object",
        "title": "AsyncAPI",
        "icon": "ApiDoc",
        "spec": "async-api"
      },
      "repository": {
        "type": "string",
        "title": "Repository",
        "icon": "Github",
        "format": "url"
      },
      "readme": {
        "icon": "Docs",
        "type": "string",
        "title": "README",
        "format": "markdown"
      },
      "code_samples": {
        "type": "string",
        "title": "Code Samples",
        "icon": "Docs",
        "format": "markdown"
      },
      "mermaid_diagram": {
        "icon": "DefaultProperty",
        "type": "string",
        "title": "Mermaid",
        "format": "markdown"
      },
      "labels": {
        "icon": "DefaultProperty",
        "type": "array",
        "title": "Labels",
        "items": {
          "enum": [
            "Auditing",
            "Critical",
            "Data Lake"
          ],
          "enumColors": {
            "Auditing": "green",
            "Critical": "red",
            "Data Lake": "blue"
          },
          "type": "string"
        }
      },
      "version": {
        "type": "string",
        "title": "Version",
        "icon": "Rocket"
      },
      "deprecated": {
        "type": "boolean",
        "title": "Deprecated?",
        "default": false
      },
      "deprecation_date": {
        "type": "string",
        "title": "Deprecation Date",
        "icon": "Clock",
        "format": "date-time"
      },
      "event_schema": {
        "type": "string",
        "title": "Event Schema",
        "icon": "Docs",
        "format": "markdown"
      },
      "number_of_consumers": {
        "title": "Number of Consumers",
        "icon": "DefaultProperty",
        "type": "number"
      },
      "number_of_producers": {
        "title": "Number Of Producers",
        "icon": "DefaultProperty",
        "type": "number"
      }
    },
    "required": [
      "deprecated"
    ]
  },
  "mirrorProperties": {},
  "calculationProperties": {},
  "aggregationProperties": {},
  "relations": {
    "consumers": {
      "title": "Consumers",
      "target": "consumer",
      "required": false,
      "many": true
    },
     "pipeline": {
      "title": "Event Pipeline I'm Sent To",
      "target": "pipeline",
      "required": false,
      "many": false
    }
  }
}
```
</details>

<details>
<summary>Example consumer blueprint</summary>

```json showLineNumbers
{
  "identifier": "consumer",
  "title": "Consumer",
  "icon": "User",
  "schema": {
    "properties": {
      "confluence_docs": {
        "icon": "Confluence",
        "type": "string",
        "title": "Docs",
        "format": "url"
      },
      "owners": {
        "icon": "TwoUsers",
        "type": "array",
        "title": "Owners",
        "items": {
          "type": "string",
          "format": "user"
        }
      }
    },
    "required": []
  },
  "mirrorProperties": {},
  "calculationProperties": {},
  "aggregationProperties": {
    "number_of_services": {
      "title": "Number of Pipelines",
      "type": "number",
      "target": "pipeline",
      "calculationSpec": {
        "func": "count",
        "calculationBy": "entities"
      }
    },
    "number_of_events": {
      "title": "Number of Events",
      "type": "number",
      "target": "event",
      "calculationSpec": {
        "func": "count",
        "calculationBy": "entities"
      }
    }
  },
  "relations": {}
}
```
</details>

With all blueprints deployed, you should see all the blueprint categories in your Port catalog like this.

<img src='/img/build-your-software-catalog/sync-data-to-catalog/event-processing/event-catalog-post-blueprint-deployment-catalog-view.png' width='100%' />

### Testing your data model

After generating all the blueprints, you'll want to test your data model out by creating example entities based on each of the blueprints you created. In a real production environment, you'd be generating these entities either automatically via API or integration. 

First we will create a consumer entity based on the `Consumer` blueprint. 


### Events dashboard creation

After defining your data model in Port for the event catalog, you'll need to create a dashboard to understand and track the different events in your event catalog. This dashboard serves as a one-stop shop to for documentation, event/API schemas, consumer/producer relations, and event-related self-service actions. 

<img src='/img/build-your-software-catalog/sync-data-to-catalog/event-processing/event-catalog-events-dashboard.png' width='100%' />
